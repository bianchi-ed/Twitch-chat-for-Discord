"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class RoomState {
    constructor(client) {
        this.client = client;
    }
    preLoad() {
        return Promise.resolve({ command: 'roomstate' });
    }
    execute(message) {
        return new Promise((resolve) => {
            const tags = message.tags;
            const channelName = message.command.channel.toLowerCase();
            if (this.client.channels.has(channelName)) {
                const channel = this.client.channels.updateChannel(channelName, tags);
                if (!channel.connected) {
                    channel.connected = true;
                }
                this.client.channels.addChannel(channel);
                this.client.rawEmit('join', channel);
                return resolve();
            }
            const channel = this.client.channels.generateChannelFromTwitch(channelName, tags);
            channel.connected = true;
            this.client.channels.addChannel(channel);
            this.client.rawEmit('join', channel);
            return resolve();
        });
    }
}
exports.default = RoomState;
